<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>微信心形动画</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background: #000;
        }
        canvas {
            touch-action: none;
        }
    </style>
</head>
<body>
<canvas id="heartCanvas"></canvas>

<script>
    const canvas = document.getElementById('heartCanvas');
    const ctx = canvas.getContext('2d');

    // 适配屏幕尺寸
    function resizeCanvas() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    }
    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    // 心形参数
    let t = 0;
    const particles = [];
    const colors = ['#ff1177', '#ff2299', '#ff33aa', '#ff44bb'];

    // 笛卡尔心形函数（调整后的参数方程）
    function getHeartPosition(angle) {
        const scale = Math.min(canvas.width, canvas.height) * 0.15;
        const x = scale * (16 * Math.pow(Math.sin(angle), 3));
        const y = -scale * (13 * Math.cos(angle) - 5 * Math.cos(2*angle) 
                    - 2 * Math.cos(3*angle) - Math.cos(4*angle));
        return {x, y};
    }

    // 创建粒子
    class Particle {
        constructor() {
            this.angle = Math.random() * Math.PI * 2;
            this.speed = 0.01 + Math.random() * 0.03;
            this.radius = 1 + Math.random() * 3;
            this.color = colors[Math.floor(Math.random()*colors.length)];
        }

        update() {
            this.angle += this.speed;
            const pos = getHeartPosition(this.angle);
            
            // 添加随机偏移
            this.x = pos.x + canvas.width/2 + (Math.random()-0.5)*10;
            this.y = pos.y + canvas.height/2 + (Math.random()-0.5)*10;
        }
    }

    // 初始化粒子
    for (let i = 0; i < 200; i++) {
        particles.push(new Particle());
    }

    // 动画循环
    function animate() {
        ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        particles.forEach(p => {
            p.update();
            ctx.beginPath();
            ctx.fillStyle = p.color;
            ctx.arc(p.x, p.y, p.radius, 0, Math.PI*2);
            ctx.fill();
        });

        requestAnimationFrame(animate);
    }

    // 启动动画
    animate();

    // 添加点击特效
    canvas.addEventListener('click', function(e) {
        for (let i = 0; i < 20; i++) {
            particles.push(new Particle());
        }
    });
</script>
</body>
</html>
